# 📧 郵件發送系統使用指南

## 🚀 快速開始

### 第一步：啟動系統

1. 打開終端機（Terminal）
2. 進入專案目錄：
   ```bash
   cd "/Users/caijunchang/Desktop/程式專案資料夾/冠軍區/郵件發送系統"
   ```

3. 安裝依賴（如果還沒安裝）：
   ```bash
   npm install
   ```

4. 啟動伺服器：
   ```bash
   npm start
   ```

5. 系統會顯示：
   ```
   伺服器運行在 http://localhost:3000
   請在瀏覽器中訪問：http://localhost:3000
   ```

6. 在瀏覽器打開：`http://localhost:3000`

---

## 🔐 第二步：設定 Gmail 應用程式密碼

**重要：** 不能直接使用 Gmail 密碼，必須使用「應用程式專用密碼」！

### 步驟 1：啟用兩步驟驗證

1. 前往 [Google 帳戶設定](https://myaccount.google.com/)
2. 點擊左側選單的「安全性」
3. 找到「兩步驟驗證」並啟用（如果還沒啟用）

### 步驟 2：產生應用程式專用密碼

1. 在「安全性」頁面，找到「應用程式密碼」區段
   - 如果沒看到，點擊「兩步驟驗證」→ 往下找到「應用程式密碼」
   
2. 或者直接前往：https://myaccount.google.com/apppasswords

3. 選擇應用程式：選擇「郵件」
4. 選擇裝置：選擇「其他（自訂名稱）」
5. 輸入名稱：例如「郵件發送系統」
6. 點擊「產生」

7. **複製產生的 16 位數密碼**（例如：`abcd efgh ijkl mnop`）
   - 這個密碼只會顯示一次，請妥善保存！

---

## 📨 第三步：發送郵件

### 在網頁介面中操作：

1. **打開「發送郵件」標籤頁**（預設就是這個頁面）

2. **填入發送者資訊：**
   - **發送者 Gmail 信箱**：輸入您的完整 Gmail 地址
     - 例如：`yourname@gmail.com`
   - **Gmail 應用程式密碼**：貼上剛才產生的 16 位數密碼
     - 注意：不是您的 Gmail 登入密碼！

3. **撰寫郵件：**
   - **郵件主旨**：例如「感謝您的支持」
   - **郵件內容**：撰寫您要發送的內容
     - 💡 **小技巧**：使用 `{name}` 會自動替換為客戶名稱
     - 例如：
       ```
       親愛的 {name}，
       
       感謝您的支持！
       
       此致
       敬禮
       ```

4. **選擇收件人：**
   - 預設已選擇「✅ 全部客戶」
   - 如果想選擇特定客戶：
     - Windows：按住 `Ctrl` 鍵點擊客戶
     - Mac：按住 `Cmd` 鍵點擊客戶
     - 可以多選多個客戶

5. **點擊「📧 發送郵件」按鈕**

6. **等待發送完成：**
   - 系統會顯示發送結果
   - 例如：「成功發送 100 封郵件，失敗 0 封」

---

## ⚠️ 重要注意事項

### Gmail 發送限制
- **每日發送上限**：約 500 封郵件
- 如果超過限制，會收到錯誤訊息
- 建議分批發送，避免超過限制

### 安全提醒
- ✅ **使用**：應用程式專用密碼（16 位數）
- ❌ **不要使用**：Gmail 登入密碼
- 應用程式密碼可以隨時在 Google 帳戶中撤銷

### 郵件內容提示
- 使用 `{name}` 會自動替換為每個客戶的名稱
- 如果客戶沒有名稱，會顯示「客戶」
- 支援 HTML 格式（可以加入連結、粗體等）

---

## 🛠️ 疑難排解

### 問題 1：無法發送郵件

**可能原因：**
- ❌ 使用了 Gmail 登入密碼（應該用應用程式密碼）
- ❌ 兩步驟驗證未啟用
- ❌ 應用程式密碼輸入錯誤

**解決方法：**
1. 確認已啟用兩步驟驗證
2. 重新產生應用程式密碼
3. 確認複製的密碼沒有多餘空格

### 問題 2：顯示「認證失敗」

**解決方法：**
1. 檢查 Gmail 地址是否正確
2. 確認應用程式密碼是否正確
3. 嘗試重新產生新的應用程式密碼

### 問題 3：部分郵件發送失敗

**可能原因：**
- Email 地址格式錯誤
- 收件人信箱已滿
- 被收件人的郵件伺服器拒絕

**解決方法：**
- 檢查失敗的郵件列表
- 確認 Email 地址是否正確
- 可以稍後再試發送失敗的郵件

---

## 💡 使用技巧

### 技巧 1：分批發送
如果客戶很多（超過 500 人），建議：
1. 先選擇部分客戶發送
2. 等待一段時間後再發送下一批

### 技巧 2：測試發送
發送前建議：
1. 先選擇 1-2 個客戶測試
2. 確認郵件格式和內容正確
3. 再發送給全部客戶

### 技巧 3：個人化郵件
使用 `{name}` 讓每封郵件都個人化：
```
親愛的 {name}，

感謝您一直以來的支持！

祝您
身體健康

[您的名字]
```

---

## 📞 需要幫助？

如果遇到問題：
1. 檢查瀏覽器控制台是否有錯誤訊息
2. 確認伺服器是否正常運行
3. 檢查網路連線是否正常

---

**祝您使用愉快！** 🎉
